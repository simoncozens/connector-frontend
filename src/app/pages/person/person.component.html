<ion-header>
  <ion-navbar>
    <ion-item>
      <button ion-button menuToggle>
        <ion-icon name="menu"></ion-icon>
      </button>
      <ion-avatar item-left><img [src]="sanitize(person?.picture)"/></ion-avatar>
      <ion-title>{{person?.name}}</ion-title>
    </ion-item>
  </ion-navbar>
</ion-header>

<ion-content>
  <ion-grid *ngIf="person">
    <ion-row>
        <a *ngIf="person.email" href="mailto:{{person?.email}}" class="btn-lg"><ion-icon name="mail"></ion-icon></a>

        <span class="role label label-info" *ngFor="let role of person?.roles">{{role}}</span>

        <a (click)="messages(person.id)" class="btn btn-primary">
        <ion-icon name="mail-open"></ion-icon> Message</a>
        <span *ngIf="person.followed">
          <button ion-button (click)="unfollow()">Unfollow</button>
        </span>
        <span *ngIf="!person.followed">
          <button ion-button outline (click)="follow()">Follow</button>
        </span>
    </ion-row>
    <ion-row>
      <ion-col col-4>Preferred Method of Contact</ion-col>
      <ion-col col-8>{{person?.preferred_contact}}</ion-col>
    </ion-row>
    <ion-row>
      <ion-col col-4>Introductory Bio</ion-col>
      <ion-col col-8>{{person?.intro_bio}}</ion-col>
    </ion-row>
    <ion-row>
      <ion-col col-4>Experience</ion-col>
      <ion-col col-8>
        <span  *ngFor="let e of person?.experience; let last = last">
          <a (click)="peopleSearch({'experience':e})">{{e}}</a><span *ngIf="!last">, </span>
        </span>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col col-4>Regions</ion-col>
      <ion-col col-8>
        <span  *ngFor="let r of person?.regions; let last = last">
          <a (click)="peopleSearch({'region':r})">{{e}}</a><span *ngIf="!last">, </span>
        </span>
      </ion-col>
    </ion-row>

    <div *ngFor="let affiliation of person?.affiliations; let i = index; ">
      <ion-row>
        <ion-col col-4>
            <span *ngIf="i==0">Primary</span>
            <span *ngIf="i!=0">Other</span>
            Organisation
        </ion-col>
        <ion-col col-8> {{affiliation.organisation}} </ion-col>
      </ion-row>
      <ion-row>
        <ion-col col-4>
            <span *ngIf="i==0">Primary</span>
            <span *ngIf="i!=0">Other</span>
            Position
        </ion-col>
        <ion-col col-8> {{affiliation.position}} </ion-col>
      </ion-row>
      <ion-row>
        <ion-col col-4> Organisation Website </ion-col>
        <ion-col col-8> {{affiliation.website}} </ion-col>
      </ion-row>
    </div>

    <ion-row>
      <ion-col col-4> My notes</ion-col>
      <ion-col col-8>
        <textarea [(ngModel)]='annotation' (keydown.enter)="saveAnnotation();false"></textarea>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>